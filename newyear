import javafx.animation.*;
import javafx.application.Application;
import javafx.geometry.Pos;
import javafx.scene.Scene;
import javafx.scene.control.*;
import javafx.scene.layout.*;
import javafx.scene.paint.Color;
import javafx.scene.shape.Circle;
import javafx.scene.text.Font;
import javafx.stage.Stage;
import javafx.util.Duration;

import java.util.Random;

public class NewYearApp extends Application {

    private boolean answered = false;

    public static void main(String[] args) {
        launch(args);
    }

    @Override
    public void start(Stage stage) {
        // Create main layout
        VBox root = new VBox(20);
        root.setAlignment(Pos.CENTER);
        root.setStyle("-fx-background-color: linear-gradient(to bottom, #ffefd5, #ffe4e1); -fx-padding: 20;");

        // Title
        Label title = new Label("ChÃºc Má»«ng NÄƒm Má»›i 2025! ðŸŒŸ");
        title.setFont(new Font("Arial", 36));
        title.setTextFill(Color.ORANGE);
        root.getChildren().add(title);

        // Intro
        Label intro = new Label("ChÃºc báº¡n vÃ  gia Ä‘Ã¬nh nÄƒm má»›i an khang, thá»‹nh vÆ°á»£ng, váº¡n sá»± nhÆ° Ã½! ðŸŒ¸");
        intro.setFont(new Font("Arial", 18));
        intro.setTextFill(Color.DARKRED);
        root.getChildren().add(intro);

        // Game question
        Label question = new Label("Sáº¯p xáº¿p cÃ¡c tá»« sau thÃ nh má»™t cÃ¢u cÃ³ nghÄ©a: \"Truyá»n, BÃ´ng, Than\"");
        question.setFont(new Font("Arial", 20));
        root.getChildren().add(question);

        // Input field
        TextField answerField = new TextField();
        answerField.setPromptText("Nháº­p cÃ¢u tráº£ lá»i cá»§a báº¡n...");
        answerField.setMaxWidth(300);
        root.getChildren().add(answerField);

        // Submit button
        Button submitButton = new Button("Tráº£ Lá»i");
        submitButton.setStyle("-fx-background-color: #ff6347; -fx-text-fill: white; -fx-font-size: 16px; -fx-padding: 10px;");
        root.getChildren().add(submitButton);

        // Result label
        Label resultLabel = new Label();
        resultLabel.setFont(new Font("Arial", 20));
        root.getChildren().add(resultLabel);

        // Handle button click
        submitButton.setOnAction(e -> {
            if (answered) return;

            String answer = answerField.getText().trim();
            if (answer.equalsIgnoreCase("BÃ´ng Truyá»n Than")) {
                Random random = new Random();
                int luckyMoney = (random.nextInt(10) + 1) * 1000; // Random tá»« 1k - 10k
                resultLabel.setText("ðŸŽ‰ Báº¡n tráº£ lá»i Ä‘Ãºng! Báº¡n nháº­n Ä‘Æ°á»£c lÃ¬ xÃ¬: " + luckyMoney + " Ä‘");
                resultLabel.setTextFill(Color.GREEN);
            } else {
                resultLabel.setText("âŒ Sai rá»“i! HÃ£y thá»­ láº¡i!");
                resultLabel.setTextFill(Color.RED);
            }

            answered = true;
            submitButton.setDisable(true);
        });

        // Add falling petals
        Pane petalPane = new Pane();
        petalPane.setPrefSize(800, 600);
        root.getChildren().add(petalPane);
        Timeline petalAnimation = new Timeline(new KeyFrame(Duration.millis(300), e -> createPetal(petalPane)));
        petalAnimation.setCycleCount(Animation.INDEFINITE);
        petalAnimation.play();

        // Set scene and stage
        Scene scene = new Scene(root, 800, 600);
        stage.setScene(scene);
        stage.setTitle("ChÃºc Má»«ng NÄƒm Má»›i 2025");
        stage.show();
    }

    private void createPetal(Pane pane) {
        Random random = new Random();
        Circle petal = new Circle(10, Color.PINK);
        petal.setTranslateX(random.nextDouble() * pane.getWidth());
        pane.getChildren().add(petal);

        TranslateTransition fall = new TranslateTransition(Duration.seconds(5), petal);
        fall.setFromY(-20);
        fall.setToY(pane.getHeight() + 20);
        fall.setOnFinished(e -> pane.getChildren().remove(petal));

        RotateTransition sway = new RotateTransition(Duration.seconds(2), petal);
        sway.setFromAngle(-15);
        sway.setToAngle(15);
        sway.setCycleCount(Animation.INDEFINITE);
        sway.setAutoReverse(true);

        ParallelTransition animation = new ParallelTransition(fall, sway);
        animation.play();
    }
}
